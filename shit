application/x-openoffice-embed-source-xml;windows_formatname="Star Embed Source (XML)"
25ca
PKï¿½ZX^ï¿½2''mimetypeapplication/vnd.oasis.opendocument.textPKï¿½ZXmanifest.rdfÍ“ï¿½nï¿½0ï¿½ï¿½<ï¿½eï¿½ï¿½@/r(Ê¹jï¿½ï¿½5ï¿½X/ï¿½Þ¾ï¿½ï¿½VQï¿½ï¿½ï¿½ï¿½ï¿½F3ßŽï¿½ï¿½ï¿½aÈ‹ï¿½ï¿½ï¿½T4c)%ï¿½Hhï¿½ï¿½+:ï¿½.ï¿½ï¿½ï¿½:ï¿½Ø¶+ï¿½ï¿½jï¿½ï¿½ï¿½*ï¿½wn*9_ï¿½ï¿½-7lÏ³ï¿½(xï¿½ï¿½]Wkï¿½zï¿½:ï¿½ï¿½?ï¿½ï¿½?(=ï¿½ï¿½]^^Vï¿½ï¿½ï¿½[ï¿½R/7:ï¿½Å›ï¿½ï¿½ï¿½ï¿½ï¿½>Vï¿½ï¿½/wï¿½_ï¿½ï¿½ï¿½jï¿½ï¿½ï¿½Vï¿½_ï¿½ï¿½ï¿½Xï¿½aï¿½ï¿½ï¿½ï¿½j-ï¿½ï¿½)ï¿½ï¿½:Ûœï¿½.;eï¿½|ï¿½ï¿½3ï¿½ï¿½ï¿½ï¿½*Ûžï¿½ï¿½ï¿½ï¿½xï¿½ï¿½ï¿½UVYï¿½cï¿½ï¿½#ï¿½ï¿½Uï¿½jgWÕ·Bï¿½Üƒï¿½ï¿½ï¿½ï¿½ï¿½cï¿½l}ï¿½Wï¿½V+'ï¿½ï¿½,ï¿½ï¿½ï¿½ï¿½5Aï¿½aï¿½ï¿½ï¿½ï¿½
ï¿½0YiXï¿½ï¿½a:ï¿½ï¿½ï¿½ï¿½ï¿½@_Å°Kï¿½ï¿½	ï¿½Cï¿½ï¿½ï¿½.ï¿½ï¿½ï¿½ï¿½Bï¿½ï¿½ï¿½pï¿½ï¿½Hj.ï¿½P+ï¿½Aï¿½iï¿½}ï¿½|/ï¿½#pï¿½1ï¿½ï¿½+ï¿½ï¿½ï¿½ï¿½ï¿½lY
.ï¿½ï¿½ï¿½$tï¿½ï¿½1ï¿½2ï¿½-%ï¿½Vï¿½Jï¿½ï¿½Kï¿½EO3ï¿½rï¿½ï¿½ï¿½%ï¿½ï¿½5ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ú‰,ï¿½)ï¿½ï¿½é¹¥Fï¿½Di[iXï¿½ï¿½ï¿½ï¿½ï¿½* Q"Mï¿½eï¿½Ht8ï¿½ï¿½ï¿½L^~Sï¿½ï¿½ï¿½ï¿½'
7ifï¿½ï¿½_ï¿½-ï¿½ï¿½ï¿½fï¿½ï¿½67.ï¿½Ó©Ëï¿½2ï¿½ï¿½Ã—`Ia>ï¿½ï¿½ï¿½[ï¿½ï¿½2ï¿½@ï¿½8ï¿½h\ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½p9aï¿½ï¿½ï¿½d:\ï¿½.ß’Aï¿½ï¿½ï¿½sï¿½Lï¿½,ï¿½cXtï¿½Nï¿½ï¿½ï¿½<ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ZÐ}ÏŽ!}ï¿½@gÕ²ZJï¿½)B`Oï¿½ï¿½uï¿½}%	ï¿½	ï¿½ï¿½ï¿½ï¿½TUÎ«hï¿½4ï¿½#ï¿½3ï¿½ï¿½ï¿½ï¿½cï¿½+
gï¿½^M+ï¿½ï¿½ï¿½f ï¿½ï¿½ï¿½oï¿½2Wï¿½ï¿½ï¿½1ï¿½ï¿½ï¿½Pï¿½lï¿½ï¿½@ï¿½,ï¿½xï¿½#ï¿½kï¿½ï¿½ï¿½Å¬uuï¿½^aï¿½ï¿½qIï¿½ï¿½AN\ï¿½{5ï¿½
Fï¿½ï¿½ï¿½ï¿½Uï¿½nï¿½Pï¿½3ï¿½ï¿½vWBY Pï¿½G!ï¿½ï¿½[LF ï¿½ï¿½(ï¿½{-ï¿½ï¿½`5ï¿½(ï¿½H|ï¿½lï¿½ï¿½#ï¿½Fï¿½ï¿½ï¿½ï¿½ï¿½cÕ•1Èï¿½ï¿½ï¿½ï¿½({dWï¿½ï¿½ï¿½ï¿½aFï¿½ï¿½,ï¿½ï¿½*
ï¿½ï¿½ï¿½!ï¿½ï¿½ï¿½aØ¿ï¿½ï¿½ï¿½=ï¿½ÊµFWï¿½ï¿½fï¿½ï¿½)ï¿½ï¿½ï¿½oï¿½ï¿½ï¿½ï¿½=ï¿½ï¿½M2ï¿½ï¿½qï¿½ï¿½ï¿½ï¿½cï¿½kï¿½ï¿½hï¿½rï¿½ï¿½nï¿½ï¿½ï¿½mï¿½GXKTï¿½ï¿½;fï¿½vÖ§QuÏˆï¿½Û Qrï¿½-Uï¿½ï¿½ï¿½+ï¿½ï¿½ï¿½Ï’SlhG(ï¿½ï¿½1ï¿½[Cï¿½ï¿½=ï¿½:ï¿½.fvï¿½ï¿½ï¿½uTB"Bï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½yï¿½xï¿½Fä£ˆï¿½Etï¿½hï¿½ï¿½0ï¿½H<ï¿½ï¿½ï¿½v{Dï¿½E\2Nï¿½Qï¿½ï¿½fï¿½Hï¿½2ï¿½"ï¿½ï¿½ï¿½fï¿½>ï¿½Lï¿½ï¿½ï¿½ï¿½ï¿½Q,Ê“ï¿½Jï¿½hGï¿½+	ï¿½Rï¿½ï¿½Wmï¿½ï¿½\Pï¿½K]4[Wï¿½ï¿½*Nï¿½ï¿½Ø±ï¿½uRLË‹ï¿½M.ï¿½^ï¿½[Lï¿½ï¿½ï¿½ï¿½ï¿½ï¿½#ï¿½7Kï¿½ï¿½gï¿½ï¿½Oï¿½/Jï¿½ï¿½uM*Uï¿½ï¿½Lï¿½ï¿½sï¿½Üº-ï¿½<ï¿½ï¿½ï¿½ï¿½ï¿½(ï¿½]G)ï¿½bW3ï¿½ï¿½rï¿½ï¿½ï¿½n ï¿½Lbï¿½Veï¿½Yï¿½Zï¿½	7ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½#LbAï¿½
$Wï¿½ï¿½
5aï¿½ï¿½Ú¿tï¿½ï¿½l.
ï¿½^ï¿½ï¿½Ì«ï¿½!Mï¿½qï¿½è•’}Pï¿½1ï¿½5ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½zg}uSï¿½wxoï¿½
ï¿½ï¿½Mï¿½5LaZï¿½vï¿½ï¿½JBï¿½~nkh
3Â”ï¿½ï¿½pï¿½Ü”ï¿½ï¿½83ï¿½ï¿½ï¿½
ï¿½ï¿½ï¿½yDï¿½ï¿½Jï¿½X#6s3ï¿½hï¿½C8ï¿½ï¿½ï¿½Å¬#ï¿½enï¿½ï¿½ï¿½
Ý¶ï¿½ÛŒ'ï¿½ï¿½\ï¿½Yï¿½Aw&ï¿½
ï¿½lMï¿½ï¿½JÊžï¿½:dï¿½ï¿½ï¿½ï¿½JpË’ï¿½ï¿½ï¿½ï¿½ï¿½Ë§Kï¿½ï¿½ï¿½0ï¿½9T[?ï¿½ï¿½{T*ï¿½^Qtyï¿½ï¿½ï¿½ï¿½ï¿½xï¿½jï¿½yï¿½ï¿½wï¿½iï¿½ï¿½ï¿½ï¿½ï¿½`:Eï¿½$ï¿½Ó‡ï¿½2.j
ï¿½È…Dï¿½ï¿½(Tï¿½ï¿½Xï¿½ï¿½yakï¿½ï¿½ï¿½ï¿½ï¿½5o8ï¿½,>ï¿½rcï¿½ï¿½ï¿½=ï¿½\ï¿½ï¿½Pu8ï¿½ï¿½ ï¿½"Â±ï¿½Dá¡º4oï¿½ï¿½ï¿½hï¿½ï¿½Ë·fï¿½ï¿½jbï¿½ï¿½uË‡*9Jï¿½ï¿½ï¿½gï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Pï¿½eï¿½ï¿½fï¿½wï¿½ERï¿½ï¿½ï¿½ï¿½ï¿½9ï¿½ï¿½é†ˆï¿½ï¿½ï¿½ï¿½m?ï¿½_8Ì›ï¿½@Oï¿½<]ï¿½|.ï¿½ï¿½"Mï¿½ï¿½Jiï¿½A5	33m]ï¿½ï¿½Bï¿½Rï¿½2Laï¿½ï¿½ï¿½0ï¿½N4ï¿½ï¿½ß‰$a]ï¿½ï¿½ï¿½Kï¿½zï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Y:I ï¿½ï¿½0<ï¿½1a6Dt^ï¿½1A	sï¿½ï¿½W×©ï¿½sï¿½JD3ï¿½[ï¿½ï¿½ï¿½Ù¡ï¿½ï¿½}O0ï¿½N>ï¿½ï¿½ï¿½ï¿½Cï¿½"ï¿½"ï¿½ï¿½ï¿½ï¿½cAï¿½ï¿½ï¿½ï¿½rï¿½2ï¿½^ï¿½ï¿½ï¿½e3ï¿½ï¿½Fï¿½ï¿½ï¿½ï¿½\Dï¿½ï¿½	ï¿½ï¿½p:nqLPBb&ß½ï¿½ï¿½ï¿½Gï¿½ï¿½6ï¿½.zï¿½ï¿½ï¿½G#8KJï¿½)ï¿½ï¿½ï¿½5
ï¿½H[i[ï¿½g5ï¿½ï¿½ï¿½ï¿½~ï¿½ï¿½ï¿½ï¿½ï¿½Wï¿½ï¿½B0ï¿½}ï¿½Yï¿½ï¿½9ï¿½iï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Kï¿½aï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½q	m<ï¿½]\ï¿½d5Oï¿½ï¿½ï¿½^jï¿½{ï¿½*;ï¿½gï¿½ï¿½Aï¿½ï¿½`ï¿½ï¿½ï¿½ï¿½ÔŽï¿½ßŽï¿½+ï¿½ï¿½Eyzï¿½ï¿½ï¿½ï¿½ï¿½Jï¿½xï¿½>}ï¿½aï¿½ï¿½É©ï¿½yLï¿½ï¿½ï¿½p$ï¿½ï¿½Esï¿½Bï¿½Ä¹ï¿½ï¿½^ï¿½nOW7ï¿½Aï¿½ï¿½ï¿½{Bw{ï¿½ï¿½gï¿½ï¿½7ï¿½aï¿½ï¿½Iï¿½ï¿½=ï¿½L;ï¿½@ï¿½|ï¿½ï¿½nï¿½ï¿½lï¿½ï¿½Óœ.|ï¿½iï¿½ï¿½à·ž>ï¿½Pï¿½ï¿½ï¿½ZWï¿½.ï¿½ymï¿½Øœ>ï¿½W{ï¿½ï¿½-ï¿½ï¿½ï¿½Noï¿½ï¿½ï¿½|ï¿½?ï¿½ï¿½ï¿½ï¿½oï¿½dï¿½ï¿½nï¿½eï¿½ï¿½ï¿½ï¿½l}dï¿½Jï¿½0xï¿½ï¿½Lï¿½Bï¿½"ï¿½ï¿½ï¿½ï¿½<ï¿½gï¿½ï¿½ï¿½iï¿½ï¿½Zï¿½<ï¿½ï¿½
gï¿½ï¿½N9ï¿½WQï¿½ï¿½ï¿½ï¿½Gï¿½ï¿½ï¿½jwSï¿½
>9ï¿½
UTvmï¿½ï¿½ï¿½yaï¿½}ï¿½o^uï¿½ï¿½ï¿½ï¿½u,ï¿½=ï¿½!ï¿½/ï¿½|ï¿½ï¿½Bï¿½}ï¿½
ï¿½ï¿½iï¿½ÎŒIfï¿½ï¿½kQï¿½[ï¿½j`á…²ï¿½g-ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½a%ï¿½ï¿½Tï¿½ï¿½ï¿½ï¿½ï¿½Aï¿½ï¿½Aï¿½ï¿½.z3{ ï¿½ï¿½ï¿½f+ï¿½ï¿½i!ï¿½Kjnï¿½ï¿½ï¿½5ï¿½#qoï¿½xdhï¿½vï¿½ï¿½Bï¿½Klï¿½ï¿½ï¿½mï¿½ï¿½1~ï¿½]ÜœlKï¿½ï¿½&ï¿½ï¿½ï¿½6ï¿½ï¿½A2ï¿½y?Xï¿½Wï¿½`-ï¿½ï¿½Zï¿½ï¿½ï¿½kï¿½ï¿½ï¿½ï¿½XWï¿½`]ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Wï¿½`ï¿½ï¿½uï¿½
Vï¿½ï¿½~ï¿½n_ï¿½jï¿½ï¿½ï¿½kï¿½
Vï¿½(ï¿½ï¿½ï¿½Jï¿½$ï¿½ï¿½ÃŒ+"uï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½T^o9Wï¿½wbï¿½ï¿½ï¿½ï¿½~ï¿½ï¿½ï¿½Yï¿½ï¿½<*ï¿½Dï¿½*ï¿½;
ï¿½dï¿½9DZï¿½ï¿½[ï¿½ï¿½ï¿½ï¿½,ï¿½3ï¿½vï¿½ï¿½kD*ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½O=ï¿½%ï¿½ï¿½:ï¿½ï¿½î‚§ï¿½Rï¿½ï¿½ï¿½Vï¿½4ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Iï¿½/eï¿½ï¿½ï¿½Yï¿½!
È„ï¿½ï¿½ï¿½:
(xï¿½	ï¿½ï¿½ï¿½ï¿½}ï¿½ï¿½Yï¿½ï¿½Ô¸@0ï¿½Mï¿½_ï¿½ÜŽï¿½]ï¿½ï¿½ï¿½.zWJï¿½ï¿½ï¿½Sï¿½ï¿½Kï¿½ï¿½\(ï¿½ï¿½ï¿½ï¿½O7ï¿½7Ë¾'ï¿½6Mï¿½MÖºï¿½ï¿½ï¿½3ï¿½ZD)>ï¿½Õ™ï¿½ï¿½ï¿½Rï¿½ï¿½_ï¿½YJï¿½ut9Uï¿½ï¿½)ï¿½ï¿½Mï¿½ï¿½ï¿½Mï¿½ï¿½ï¿½mï¿½8fï¿½aZï¿½n;ï¿½ï¿½Vï¿½ï¿½ï¿½Sï¿½]$9ï¿½ï¿½ï¿½'ï¿½+ï¿½ï¿½cï¿½ÈŽCï¿½ï¿½vr^ï¿½ï¿½ï¿½3ï¿½ï¿½/ï¿½#ï¿½>ï¿½ï¿½'Xï¿½e~LBï¿½ï¿½ï¿½ï¿½ï¿½{ï¿½ï¿½ZR,ï¿½ï¿½ï¿½Ô’ï¿½hï¿½×¬ï¿½ï¿½ï¿½Íƒï¿½iï¿½ï¿½tï¿½	ï¿½ï¿½PKï¿½>ï¿½
ï¿½;PKï¿½ZXcontent.xmlï¿½]{sï¿½6ï¿½ï¿½>ï¿½7ï¿½ï¿½Æ¢%Rï¿½#ï¿½Q:×¤isï¿½ï¿½ï¿½$ï¿½ï¿½q<ï¿½ï¿½$^(ï¿½GBï¿½ï¿½ï¿½ï¿½~ï¿½Aï¿½ï¿½ï¿½ï¿½ï¿½tï¿½Lï¿½ï¿½ï¿½ï¿½]ï¿½ï¿½ï¿½~ï¿½^ï¿½ï¿½'i@ï¿½É‘}28B8ï¿½Dï¿½ï¿½ï¿½/oï¿½Zï¿½ï¿½oï¿½ï¿½!ï¿½Nï¿½}ï¿½-8ï¿½ï¿½G"
ï¿½#x;JÇ¢ï¿½29ï¿½Sï¿½ï¿½}ï¿½H<=!É¬ï¿½ï¿½}q$ï¿½ï¿½ï¿½tHUï¿½ï¿½juï¿½ï¿½o^ï¿½Yï¿½Eï¿½ï¿½ï¿½Ú³ï¿½ï¿½Ãªï¿½@yØŸï¿½}ï¿½ï¿½ï¿½Mï¿½Wï¿½ï¿½ï¿½Xï¿½ï¿½ï¿½
ï¿½ï¿½ï¿½ï¿½ï¿½Kï¿½ï¿½Sï¿½,Ö“ï¿½eï¿½sï¿½Ç‘ï¿½ï¿½ï¿½ï¿½cï¿½ï¿½ï¿½n8&^ï¿½ï¿½?ï¿½h~Bï¿½qN`ï¿½u'yï¿½ï¿½Yï¿½ï¿½ï¿½ï¿½_{sï¿½pï¿½FJï¿½(ï¿½Hï¿½=ï¿½ï¿½ï¿½OpLï¿½ï¿½ï¿½=U9^&!ï¿½ï¿½{}b&lÚ·Olï¿½=oï¿½&T6ï¿½Mï¿½Tï¿½ï¿½zï¿½ï¿½ï¿½Qï¿½Zeï¿½5ï¿½Í¬ï¿½P\cï¿½4ï¿½ï¿½Nï¿½Oï¿½U]*ï¿½.ï¿½ï¿½ï¿½:sï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Åžï¿½=7ï¿½Tcï¿½&Äµï¿½ï¿½*ï¿½Xï¿½ï¿½ï¿½Z%8NV}ï¿½ï¿½[ï¿½ï¿½[ï¿½0ï¿½>ï¿½ï¿½oVï¿½ï¿½w]&ï¿½4ï¿½ï¿½dï¿½	ï¿½ï¿½ï¿½ï¿½Rï¿½wuï¿½>Wpï¿½ï¿½_ï¿½aï¿½~ï¿½[ï¿½ï¿½ï¿½Fï¿½ï¿½ï¿½ï¿½ï¿½ï¿½'ï¿½yCï¿½ï¿½ï¿½ï¿½
ï¿½ï¿½ï¿½Qï¿½sOOf*ï¿½Nï¿½2Nï¿½ï¿½ï¿½{m\ï¿½pKï¿½
Î¼ï¿½ï¿½Yï¿½ï¿½`ï¿½ï¿½NV?$
ï¿½ï¿½&ï¿½(ï¿½O;C(ï¿½ï¿½ï¿½E9ï¿½ï¿½ï¿½zï¿½Xï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½:~ï¿½Nï¿½ï¿½ï¿½ï¿½~8ê¿€Bï¿½ï¿½ï¿½s=ï¿½ï¿½ï¿½ï¿½rbIï¿½$ï¿½kBQï¿½ï¿½0F0ï¿½ï¿½6ï¿½/ï¿½ï¿½ï¿½ÔŸï¿½Gï¿½2 ï¿½ï¿½}ï¿½`
Xï¿½ï¿½ï¿½ï¿½|ï¿½é£‡ï¿½;ï¿½ï¿½Hï¿½3I'Gï¿½ï¿½$(9Bï¿½*ï¿½*ï¿½ ï¿½ï¿½%ï¿½ï¿½Ìšï¿½LAN*eï¿½kï¿½ï¿½Aï¿½ï¿½nï¿½ï¿½ï¿½Õ«!Xï¿½
ï¿½ï¿½HgdPï¿½ß¸ï¿½;ï¿½wvï¿½Vï¿½XGï¿½MJï¿½ï¿½Dï¿½ï¿½ï¿½ï¿½
ï¿½ï¿½_ï¿½Fï¿½ï¿½Wxï¿½ï¿½dï¿½ï¿½ï¿½^ï¿½ï¿½ï¿½ï¿½ï¿½gUï¿½ï¿½o ï¿½Ýº$-ï¿½uCiï¿½bjï¿½ï¿½w[ 5ï¿½ï¿½pï¿½ï¿½gQï¿½Oï¿½^oï¿½$ï¿½ï¿½Pï¿½aï¿½?Åbï¿½V*Jï¿½IWï¿½ï¿½ï¿½ï¿½%ï¿½ï¿½Lï¿½ï¿½T
ï¿½?"ï¿½l+nRï¿½ï¿½Mï¿½Yï¿½ï¿½ï¿½ï¿½&ï¿½ï¿½ï¿½[ï¿½aï¿½ä»‰ï¿½fßŠ!ï¿½ï¿½8ï¿½ï¿½#ï¿½Nï¿½8tï¿½ï¿½ÒA)ï¿½ï¿½ï¿½	M@ï¿½_^g9ï¿½ï¿½XIdAï¿½ ï¿½ï¿½ï¿½ï¿½6×„Ö°=ï¿½tï¿½ï¿½Vï¿½oï¿½ï¿½+mï¿½^;ï¿½ï¿½ï¿½=ï¿½ï¿½Sï¿½ï¿½Ê‚kï¿½oï¿½
ï¿½ï¿½C>ï¿½Lï¿½ï¿½8ï¿½ï¿½ï¿½ï¿½Cï¿½ï¿½Aï¿½ï¿½ï¿½"K
/lï¿½OCï¿½ï¿½Hï¿½ï¿½>ï¿½eJEkï¿½ï¿½Fï¿½ï¿½dï¿½ï¿½
\y"ï¿½ï¿½ï¿½tï¿½ï¿½eï¿½ï¿½ï¿½ß­ï¿½Xï¿½ï¿½{ï¿½6YxMï¿½Ç…ï¿½|ï¿½	ï¿½iï¿½ï¿½ï¿½ï¿½ï¿½aLï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½cï¿½;ï¿½ï¿½1ï¿½%
ï¿½?)Mï¿½ï¿½%Gï¿½ï¿½ï¿½wï¿½ï¿½=$ï¿½$hATvï¿½ï¿½Bï¿½58yï¿½Dï¿½×‘N#2*Ó¡sï¿½ï¿½Pï¿½Ocï¿½}ï¿½ï¿½ï¿½6ï¿½SAzï¿½Ýï¿½CÛ¥ï¿½ï¿½>H'	ï¿½l@{ï¿½=ï¿½ï¿½\ï¿½Pï¿½!Rï¿½ï¿½Oï¿½Ø£ï¿½ï¿½ï¿½ï¿½ï¿½{ï¿½ï¿½$ï¿½ï¿½ï¿½x@ï¿½ï¿½ iuï¿½`ï¿½ï¿½E;ï¿½fï¿½Eï¿½ï¿½ï¿½G!ï¿½ï¿½#$ï¿½Aï¿½ï¿½pï¿½Lï¿½ï¿½ï¿½ï¿½
ï¿½BÖ½ï¿½F=ï¿½'
ï¿½ï¿½ï¿½ï¿½RAï¿½ï¿½D&ï¿½ï¿½5ï¿½ï¿½8 s0jFï¿½ï¿½ï¿½Uï¿½ï¿½yï¿½ï¿½8ï¿½ï¿½[ï¿½ï¿½1ï¿½ï¿½Ô€ï¿½T5{ï¿½ï¿½]ï¿½1ï¿½ï¿½{hÓ•ï¿½ï¿½ozï¿½ï¿½ï¿½1<ï¿½vï¿½ï¿½-ï¿½27ï¿½ï¿½ï¿½ï¿½Gï¿½E_4p;ï¿½Dï¿½KQGï¿½h-#ï¿½6zÓ Aï¿½:9ï¿½ï¿½[(ï¿½ï¿½Ì‘ï¿½ï¿½jï¿½ï¿½ï¿½ï¿½zï¿½']ï¿½ï¿½ï¿½ï¿½!lï¿½ï¿½0C(ï¿½ï¿½ï¿½Pï¿½ï¿½ï¿½Ê¬ï¿½+ï¿½ï¿½^)ï¿½(ï¿½ï¿½-ï¿½0	3ï¿½3Ó„ï¿½ï¿½ï¿½ï¿½	ï¿½aï¿½ï¿½É¬ï¿½F ï¿½Ó“`ï¿½'ï¿½ROï¿½ï¿½ï¿½Lï¿½=-ï¿½ï¿½dvï¿½Lï¿½Sï¿½
ï¿½ï¿½ï¿½i(ï¿½k=$ï¿½Rï¿½ï¿½ï¿½wï¿½4ï¿½ï¿½ï¿½i+nï¿½Kï¿½ ï¿½ï¿½ï¿½qï¿½}`ï¿½ï¿½qï¿½ï¿½ï¿½ï¿½\]ï¿½ï¿½ï¿½'È²ï¿½oï¿½ï¿½*ï¿½eÙ¡ï¿½ï¿½ï¿½lÍ•Lï¿½ï¿½ ï¿½ï¿½ï¿½ï¿½csYpï¿½6ï¿½ï¿½gï¿½Zï¿½ï¿½Y|ï¿½!ï¿½f"@nM:ï¿½ï¿½T%ï¿½ï¿½ï¿½b2ï¿½rEmï¿½ï¿½ï¿½ï¿½.ï¿½lEï¿½ï¿½ï¿½ï¿½ï¿½ï¿½0`nï¿½91ßŸdï¿½ï¿½)=ï¿½ï¿½.ï¿½oï¿½YÙ–%Mï¿½ï¿½Lz*ï¿½Yï¿½aï¿½ï¿½ï¿½2ï¿½ï¿½=ï¿½ï¿½ï¿½Qoï¿½og>)ï¿½ï¿½:4ï¿½;hÊ 5)bOï¿½{ï¿½ï¿½ï¿½ï¿½Ä“
ï¿½yï¿½Xp\Ë£Vï¿½ï¿½ï¿½lï¿½BOï¿½4ï¿½`Tï¿½ï¿½ï¿½ï¿½lï¿½aJIRsï¿½]ï¿½ï¿½Ë˜$:Ú˜-ï¿½wc2ï¿½3Sï¿½ï¿½mL'sVNï¿½ï¿½ï¿½ï¿½ty|ï¿½%(ï¿½ï¿½aï¿½ï¿½ï¿½ï¿½ï¿½ï¿½\,ClYOl>uÍ¦ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½H2ï¿½ï¿½Ê‚"\ï¿½@W*|z(ï¿½Ðƒï¿½hHï¿½ï¿½ï¿½ï¿½Aï¿½,kï¿½ esTQMPï¿½ï¿½Wï¿½ï¿½ï¿½hï¿½Tï¿½ï¿½Y3=Hï¿½@ï¿½jwï¿½ï¿½ï¿½9CÌ”ï¿½cï¿½?ï¿½Ï¤ï¿½M6rï¿½ï¿½ï¿½ï¿½ï¿½Ý¾ï¿½ï¿½ï¿½ï¿½Sï¿½ï¿½Ä˜ï¿½Å§R,ï¿½Rï¿½ï¿½ï¿½(ÂˆVBï¿½/(ï¿½ #|5ï¿½4ï¿½ï¿½ï¿½ï¿½#ï¿½ï¿½ï¿½ï¿½^=ï¿½hm=DbGï¿½Xï¿½ï¿½Ü¸Aï¿½6ï¿½ï¿½ï¿½20vï¿½ï¿½ï¿½aï¿½(ï¿½ï¿½Üž/4ï¿½1<"ï¿½Í¼hï¿½ï¿½ï¿½SÐ²Úï¿½F}ï¿½|Yï¿½ï¿½ï¿½Rï¿½5ï¿½ï¿½!@eï¿½?ï¿½q~i8?ï¿½ï¿½|m#ï¿½>* ï¿½*ï¿½Qï¿½]ï¿½ï¿½V*7ï¿½
ï¿½ï¿½An0ÛŸï¿½o+ï¿½.ï¿½O0tï¿½ï¿½Oï¿½n
ï¿½ï¿½ï¿½
ï¿½o{ï¿½ï¿½ÑƒÑ»ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê­ï¿½7Iï¿½ï¿½ï¿½ï¿½ï¿½ï¿½}ï¿½ï¿½ï¿½ï¿½wï¿½ï¿½7MHDï¿½ï¿½ï¿½ 
hï¿½lÐ¼ï¿½Eï¿½ï¿½"_Hï¿½ï¿½9ï¿½6\ï¿½]ï¿½/	ï¿½a^ï¿½bï¿½ï¿½?ï¿½iï¿½D.ï¿½mï¿½lï¿½ï¿½Bjï¿½ï¿½QX"ï¿½Í¯	ï¿½|pï¿½YÛ‚ï¿½ewÙ®%~kÙŒï¿½ï¿½ï¿½ï¿½oï¿½Eï¿½%+ï¿½ï¿½ze~ï¿½ï¿½ï¿½ï¿½ï¿½\ï¿½/5)ï¿½AHï¿½`ï¿½ï¿½ï¿½xD @ï¿½5ï¿½jï¿½Yvï¿½Mï¿½ï¿½	0vï¿½uï¿½ï¿½6m
ï¿½6H[ï¿½nï¿½Ó¶ï¿½iï¿½ï¿½ï¿½vï¿½V(yï¿½x
zï¿½Ê¯7ï¿½ï¿½ï¿½Jï¿½3i:#lï¿½ï¿½%ï¿½ï¿½ï¿½ï¿½Y>ï¿½zï¿½^ï¿½Bï¿½lï¿½<ï¿½nï¿½ï¿½PAÆ¢nï¿½ï¿½Lï¿½_eï¿½ï¿½ï¿½XwÌ ï¿½ï¿½× ï¿½7Ehï¿½Üµï¿½G!0bGO1ï¿½ï¿½ï¿½ï¿½ï¿½lï¿½.Dï¿½_ï¿½	ï¿½ï¿½ï¿½4ï¿½ï¿½xï¿½ï¿½|È­ï¿½Ù–ï¿½G3ï¿½P}ï¿½ï¿½ï¿½Ý’dï¿½}ï¿½TCï¿½ï¿½;ï¿½ï¿½ÈšQï¿½Hï¿½ï¿½ï¿½$8ï¿½ï¿½@'Dï¿½ï¿½Iï¿½|@ï¿½yï¿½ï¿½6ï¿½ï¿½ï¿½ßŽnï¿½ï¿½~wï¿½o&5ï¿½ï¿½YOï¿½]ÙŽk6XMcvï¿½5H1ï¿½5jï¿½Sï¿½/1Lï¿½ï¿½l=ï¿½ï¿½ï¿½=9tï¿½ï¿½:H)ï¿½s_ï¿½ï¿½ï¿½ï¿½lï¿½#ï¿½Ñ¤0;ï¿½ï¿½ï¿½Ðµï¿½ï¿½qï¿½Wï¿½Beuï¿½FrkSï¿½Ø¨ï¿½ ï¿½ï¿½oï¿½dÆ²ï¿½ï¿½tï¿½Qï¿½ï¿½ï¿½ï¿½ï¿½*ï¿½ï¿½/ï¿½qï¿½g=Rï¿½7Q,ï¿½ï¿½ï¿½Yï¿½u4ï¿½ï¿½C9FGï¿½ï¿½32ï¿½Aï¿½ï¿½Mï¿½tï¿½ï¿½ï¿½w2ï¿½~Êsï¿½?QjÂ‰gï¿½ï¿½ï¿½Uï¿½3	ï¿½ï¿½ï¿½Aï¿½7Èƒï¿½ï¿½ï¿½Q"cWï¿½=_Uï¿½Î”Azï¿½y<ï¿½ï¿½ÙSï¿½ï¿½ï¿½AL%ï¿½3Yï¿½Dï¿½ï¿½ï¿½oï¿½s*ï¿½#ï¿½ï¿½D5OGï¿½ï¿½h<9à¸µ-ï¿½ï¿½qvï¿½ï¿½Wï¿½ï¿½!!ï¿½q~n[ï¿½Ã„ï¿½ï¿½xï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Rï¿½ï¿½MQï¿½|'ï¿½ï¿½ï¿½Sï¿½H0ï¿½ï¿½4ï¿½ï¿½2ï¿½æ¥›ï¿½tsï¿½tï¿½ï¿½*ï¿½uï¿½ï¿½ï¿½ï¿½UTï¿½gï¿½ï¿½*ï¿½mï¿½iSGï¿½zï¿½zs-ï¿½ï¿½ï¿½1_ï¿½+ï¿½ï¿½ï¿½Bï¿½ï¿½ï¿½Lï¿½Tï¿½ï¿½3ï¿½gjï¿½Ò–ï¿½ï¿½|ï¿½}&g'ï¿½ï¿½ï¿½Hï¿½ï¿½SEï¿½ï¿½ï¿½yï¿½ï¿½:ï¿½OÄ·ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
ï¿½;
?styles.xmlPKï¿½ZXï¿½ï¿½h]4tï¿½content.xmlPKï¿½ZXï¿½ï¿½ï¿½^ï¿½ï¿½#META-INF/manifest.xmlPK^V$
text/rtf
147eb
{\rtf1\ansi\deff3\adeflang1025
{\fonttbl{\f0\froman\fprq2\fcharset0 Times New Roman;}{\f1\froman\fprq2\fcharset2 Symbol;}{\f2\fswiss\fprq2\fcharset0 Arial;}{\f3\froman\fprq2\fcharset0 Carlito{\*\falt Calibri};}{\f4\fswiss\fprq2\fcharset0 Liberation Sans{\*\falt Arial};}{\f5\fmodern\fprq1\fcharset0 Liberation Mono{\*\falt Courier New};}{\f6\fnil\fprq0\fcharset2 OpenSymbol{\*\falt Arial Unicode MS};}{\f7\fmodern\fprq1\fcharset0 Noto Sans Mono CJK SC;}{\f8\fnil\fprq2\fcharset0 Noto Sans CJK SC Regular;}{\f9\fswiss\fprq0\fcharset128 Noto Sans Devanagari;}{\f10\fnil\fprq2\fcharset0 Lohit Devanagari;}}
{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0;\red255\green0\blue255;\red255\green0\blue0;\red255\green255\blue0;\red255\green255\blue255;\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;\red128\green128\blue128;\red192\green192\blue192;}
{\stylesheet{\s0\snext0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052 Normal;}
{\*\cs10\snext10\rtlch\af5 \ltrch\hich\af5\loch\f5\dbch\af7 Source Text;}
{\*\cs11\snext11\rtlch\af6 \ltrch\hich\af6\loch\f6\dbch\af6 Bullets;}
{\*\cs12\snext12\rtlch\ab \ltrch\loch\b Strong;}
{\*\cs13\snext13 Numbering Symbols;}
{\s14\sbasedon0\snext14\rtlch\af5\afs20 \ltrch\hich\af5\loch\sb0\sa0\f5\fs20\dbch\af7 Preformatted Text;}
{\s15\sbasedon0\snext15\rtlch\af9 \ltrch\loch\noline Index;}
{\s16\sbasedon0\snext16\rtlch\af9\afs24\ai \ltrch\loch\sb120\sa120\noline\fs24\i Caption;}
{\s17\sbasedon18\snext17\rtlch\af9 \ltrch\loch\sl276\slmult1\sb0\sa140 List;}
{\s18\sbasedon0\snext18\loch\sl276\slmult1\sb0\sa140 Body Text;}
{\s19\sbasedon0\snext18\rtlch\af10\afs28 \ltrch\hich\af4\loch\sb240\sa120\keepn\f4\fs28\dbch\af8 Heading;}
}{\*\generator Collabora_Office/22.05.15.2$Linux_X86_64 LibreOffice_project/e747ea966384ab782a6aac38b4ec99d38c5fd2e9}{\info{\creatim\yr0\mo0\dy0\hr0\min0}{\revtim\yr0\mo0\dy0\hr0\min0}{\printim\yr0\mo0\dy0\hr0\min0}}{\*\userprops}\deftab709
\hyphauto1
{\*\pgdsctbl
{\pgdsc0\pgdscuse451\pgwsxn12240\pghsxn15840\marglsxn1134\margrsxn1134\margtsxn1134\margbsxn1134\pgdscnxt0 Default Page Style;}}
\formshade\paperh15840\paperw12240\margl1134\margr1134\margt1134\margb1134\sectd\sbknone\pgndec\sftnnar\saftnnrlc\sectunlocked1\pgwsxn12240\pghsxn15840\marglsxn1134\margrsxn1134\margtsxn1134\margbsxn1134\ftnbj\ftnstart1\ftnrstcont\ftnnar\aenddoc\aftnrstcont\aftnstart1\aftnnrlc
{\*\ftnsep\chftnsep}\pgndec\pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
{\*\bkmkstart __DdeLink__599_2946212008}{\*\bkmkend __DdeLink__599_2946212008}type UnitAttributes = (Bool,   -- playerID}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                       }{\hich\af4\loch\lang1033\f4\loch
f32,    -- speed}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                       }{\hich\af4\loch\lang1033\f4\loch
i8,     -- health}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                       }{\hich\af4\loch\lang1033\f4\loch
i8,     -- attack}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                       }{\hich\af4\loch\lang1033\f4\loch
f32,    -- range}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                       }{\hich\af4\loch\lang1033\f4\loch
Bool,   -- flying}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                       }{\hich\af4\loch\lang1033\f4\loch
Bool,   -- areaEffect}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                       }{\hich\af4\loch\lang1033\f4\loch
i8,     -- healing}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                       }{\hich\af4\loch\lang1033\f4\loch
i8,     -- originalHealth}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                       }{\hich\af4\loch\lang1033\f4\loch
i8,     -- cardID}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                       }{\hich\af4\loch\lang1033\f4\loch
i8)     -- instance}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let coordinateMapping : [(i8, i8)] -> [(i8, i8, i8)] =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
  }{\hich\af4\loch\lang1033\f4\loch
\\coords ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let zStart = 22 : i8}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
width = 22 : i8}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
height = 22 : i8}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
depth = 44 : i8}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
map (\\(x, y) -> (x, y, -(x + y))) coords}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let allCoordinates : [(i8, i8)] =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
  }{\hich\af4\loch\lang1033\f4\loch
concat (map (\\x -> map (\\y -> (x, y)) (0 ..< 14 : i8)) (0 ..< 12 : i8))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let cubeCoordinates = coordinateMapping allCoordinates}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let placeUnit : (GameState, (i8, i8), UnitAttributes, [(i8, i8, i8)]) -> (GameState, [(i8, i8, i8)]) =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
  }{\hich\af4\loch\lang1033\f4\loch
\\ (gameState, (x, y), unitAttrs, gameLog) ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let (health, attack, speed, range, flying, areaEffect, cardID, instance, playerID) = unitAttrs}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let (width, height, depth) = (22, 22, 44)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let isOccupied = gameState[x][y][0] != -1 || gameState[x][y][1] != -1}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
if isOccupied}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
then}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
(gameState, gameLog)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
else}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
let updatedGameState = map (\\z ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                  }{\hich\af4\loch\lang1033\f4\loch
map (\\y' ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                        }{\hich\af4\loch\lang1033\f4\loch
map (\\x' ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                              }{\hich\af4\loch\lang1033\f4\loch
let attrs = gameState[x'][y'][z']}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                              }{\hich\af4\loch\lang1033\f4\loch
if attrs[0] == -1 || (attrs[0] == -1 && attrs[1] == -1)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                              }{\hich\af4\loch\lang1033\f4\loch
then if playerID == False && attrs[7] == instance}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                   }{\hich\af4\loch\lang1033\f4\loch
then [health, attack, speed, range, flying, areaEffect, cardID, instance, playerID]}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                   }{\hich\af4\loch\lang1033\f4\loch
else if playerID == True && attrs[7] == instance + 1}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                        }{\hich\af4\loch\lang1033\f4\loch
then [health, attack, speed, range, flying, areaEffect, cardID, instance, playerID]}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                        }{\hich\af4\loch\lang1033\f4\loch
else attrs}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                              }{\hich\af4\loch\lang1033\f4\loch
else attrs)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                            }{\hich\af4\loch\lang1033\f4\loch
(0 ..< height))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                      }{\hich\af4\loch\lang1033\f4\loch
(0 ..< width))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                }{\hich\af4\loch\lang1033\f4\loch
(0 ..< depth)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
updatedGameLog = gameLog ++ [(x, y, cardID)]}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
(updatedGameState, updatedGameLog)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let payMana : Mana -> i8 -> i8 -> Color -> (Mana, Bool) =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
  }{\hich\af4\loch\lang1033\f4\loch
\\ mana colorCost neutralCost color ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let (enoughColorMana, newColorMana, newChromeMana) = case color of}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                          }{\hich\af4\loch\lang1033\f4\loch
Red -> if mana.red + mana.chrome >= colorCost}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                                 }{\hich\af4\loch\lang1033\f4\loch
then (True, mana.red - colorCost, if mana.red >= colorCost then mana.chrome else mana.chrome - (colorCost - mana.red))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                                 }{\hich\af4\loch\lang1033\f4\loch
else (False, mana.red, mana.chrome)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                          }{\hich\af4\loch\lang1033\f4\loch
Green -> if mana.green + mana.chrome >= colorCost}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                                   }{\hich\af4\loch\lang1033\f4\loch
then (True, mana.green - colorCost, if mana.green >= colorCost then mana.chrome else mana.chrome - (colorCost - mana.green))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                                   }{\hich\af4\loch\lang1033\f4\loch
else (False, mana.green, mana.chrome)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                          }{\hich\af4\loch\lang1033\f4\loch
Blue -> if mana.blue + mana.chrome >= colorCost}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                                  }{\hich\af4\loch\lang1033\f4\loch
then (True, mana.blue - colorCost, if mana.blue >= colorCost then mana.chrome else mana.chrome - (colorCost - mana.blue))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                                  }{\hich\af4\loch\lang1033\f4\loch
else (False, mana.blue, mana.chrome)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                          }{\hich\af4\loch\lang1033\f4\loch
Yellow -> if mana.yellow + mana.chrome >= colorCost}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                                    }{\hich\af4\loch\lang1033\f4\loch
then (True, mana.yellow - colorCost, if mana.yellow >= colorCost then mana.chrome else mana.chrome - (colorCost - mana.yellow))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                                    }{\hich\af4\loch\lang1033\f4\loch
else (False, mana.yellow, mana.chrome)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let enoughNeutralMana = colorCost + neutralCost <= newColorMana + mana.neutral}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let newNeutralMana = if enoughNeutralMana then mana.neutral + neutralCost else mana.neutral}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
if enoughColorMana && enoughNeutralMana}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
then (\{ red = if color == Red then newColorMana else mana.red,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
green = if color == Green then newColorMana else mana.green,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
blue = if color == Blue then newColorMana else mana.blue,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
yellow = if color == Yellow then newColorMana else mana.yellow,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
neutral = newNeutralMana,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
chrome = newChromeMana \}, True)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
else (mana, False)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
-- Define a type for mana stores}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
type Mana = \{ red :: i8,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
green :: i8,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
blue :: i8,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
yellow :: i8,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
neutral :: i8 \}}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
-- Function to initialize the accumulator}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let initAccumulator : Mana =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
  }{\hich\af4\loch\lang1033\f4\loch
\{ red = 0, green = 0, blue = 0, yellow = 0, neutral = 0 \}}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
-- Function to update the accumulator when mana is spent}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let updateAccumulator : Mana -> i8 -> i8 -> Color -> Mana =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
  }{\hich\af4\loch\lang1033\f4\loch
\\ acc colorCost neutralCost color ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let newRed = if color == Red then acc.red + colorCost else acc.red}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let newGreen = if color == Green then acc.green + colorCost else acc.green}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let newBlue = if color == Blue then acc.blue + colorCost else acc.blue}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let newYellow = if color == Yellow then acc.yellow + colorCost else acc.yellow}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let newNeutral = acc.neutral + neutralCost}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
\{ red = newRed, green = newGreen, blue = newBlue, yellow = newYellow, neutral = newNeutral \}}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
-- Function to calculate available mana for each color}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let availableMana : Mana -> Mana =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
  }{\hich\af4\loch\lang1033\f4\loch
\\ spentMana ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let floorHalf = \\x -> x / 2}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
\{ red = floorHalf spentMana.red,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
green = floorHalf spentMana.green,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
blue = floorHalf spentMana.blue,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
yellow = floorHalf spentMana.yellow,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
neutral = floorHalf spentMana.neutral \}}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let isValidMove : (i8, i8, i8, i8, [[[[i32]]]]) -> i32 =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
  }{\hich\af4\loch\lang1033\f4\loch
\\ (startX, startY, endX, endY, gameState) ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let rec bfs : [(i8, i8, i8)] -> [(i8, i8, i8)] -> i32 =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
\\ frontier visited ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
case frontier of}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
[] -> 0  -- No valid path found}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
(x, y, z) :: rest ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
            }{\hich\af4\loch\lang1033\f4\loch
let neighbors = [(x+1, y, z-1), (x+1, y-1, z), (x, y-1, z+1), (x-1, y, z+1), (x-1, y+1, z), (x, y+1, z-1)]}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                }{\hich\af4\loch\lang1033\f4\loch
validNeighbors = filter (\\(nx, ny, nz) ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                           }{\hich\af4\loch\lang1033\f4\loch
0 <= nx && nx < width &&}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                           }{\hich\af4\loch\lang1033\f4\loch
0 <= ny && ny < height &&}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                           }{\hich\af4\loch\lang1033\f4\loch
0 <= nz && nz < depth &&}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                           }{\hich\af4\loch\lang1033\f4\loch
gameState[toIndex nx][toIndex ny][toIndex nz][0] == -1)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                         }{\hich\af4\loch\lang1033\f4\loch
neighbors}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                }{\hich\af4\loch\lang1033\f4\loch
newFrontier = filter (\\(nx, ny, nz) -> not (contains (nx, ny, nz) visited)) validNeighbors}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                }{\hich\af4\loch\lang1033\f4\loch
newVisited = visited ++ newFrontier}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
            }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
if (x, y, z) == (endX, endY, 0)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
then 1  -- Valid path found}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
else bfs rest newVisited}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let width = length gameState}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
height = length (gameState[0])}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
depth = length (gameState[0][0])}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
startZ = -(startX + startY)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
endZ = -(endX + endY)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
if gameState[toIndex endX][toIndex endY][0] != -1}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
then 0  -- Destination space is occupied}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
else}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
if endZ == 0}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
then}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
let pathExists = bfs [(endX, endY, 0)] []}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
if pathExists == 1}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
then 1  -- Valid path found}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
else 0  -- No valid path found}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
else}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
let pathExists = bfs [(endX, endY, 0)] []}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
if pathExists == 1 && abs(endX - startX) + abs(endY - startY) <= speed}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
then 1  -- Valid path found}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
else 0  -- No valid path found}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let moveUnit : (GameState, (i8, i8, i8), (i8, i8, i8)) -> GameState =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
  }{\hich\af4\loch\lang1033\f4\loch
\\ (gameState, (x1, y1, z1), (x2, y2, z2)) ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let unitAttrs = gameState[toIndex x1][toIndex y1][playerId]}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
(health, attack, speed, range, flying, areaEffect, cardID, instance) = (unitAttrs[0], unitAttrs[1], unitAttrs[2], unitAttrs[3], unitAttrs[4], unitAttrs[5], unitAttrs[6], unitAttrs[7])}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
width = 22}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
height = 22}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
depth = 44}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
startZ = -(x1 + y1)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
endZ = -(x2 + y2)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let isValid = isValidMove x1 y1 z1 x2 y2 z2 gameState}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
if isValid == 0}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
then}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
gameState -- Target position is unreachable within the unit's speed limit}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
else}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
let updatedGameState = map (\\x ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                  }{\hich\af4\loch\lang1033\f4\loch
map (\\y ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                        }{\hich\af4\loch\lang1033\f4\loch
map (\\z ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                              }{\hich\af4\loch\lang1033\f4\loch
if (x, y, z) == (x1, y1, z1)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                              }{\hich\af4\loch\lang1033\f4\loch
then (-1, -1, -1.0, -1.0, False, False, -1, -1)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                              }{\hich\af4\loch\lang1033\f4\loch
else gameState[x][y][z]))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                    }{\hich\af4\loch\lang1033\f4\loch
(0 ..< width))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                }{\hich\af4\loch\lang1033\f4\loch
(0 ..< height)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                }{\hich\af4\loch\lang1033\f4\loch
(0 ..< depth)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
            }{\hich\af4\loch\lang1033\f4\loch
updatedGameState}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let attack : (GameState, (i8, i8), (i8, i8)) -> GameState =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
  }{\hich\af4\loch\lang1033\f4\loch
\\ (gameState, (x1, y1), (x2, y2)) ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let (health, attackPower, range, _, _, _, _) = gameState[toIndex x1][toIndex y1][playerId]}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
targetHealth = gameState[toIndex x2][toIndex y2][playerId][0]}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
(x1', y1', z1') = lookupCoordinate (x1, y1)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
(x2', y2', z2') = lookupCoordinate (x2, y2)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
newTargetHealth = if max(i8(abs(x2' - x1')), i8(abs(y2' - y1')), i8(abs(z2' - z1'))) <= range}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                          }{\hich\af4\loch\lang1033\f4\loch
then max(targetHealth - attackPower, 0)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                          }{\hich\af4\loch\lang1033\f4\loch
else targetHealth}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
updateGameState : i32 -> GameState -> GameState =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
\\ newHealth gameState' ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
            }{\hich\af4\loch\lang1033\f4\loch
let updatedUnit = if newHealth > 0 then [newHealth, attackPower, range, _, _, _, _, _, _, _] else []}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
            }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
map (\\x ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                     }{\hich\af4\loch\lang1033\f4\loch
map (\\y ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                           }{\hich\af4\loch\lang1033\f4\loch
map (\\z ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                 }{\hich\af4\loch\lang1033\f4\loch
if (x, y, z) == (x2', y2', z2')}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                 }{\hich\af4\loch\lang1033\f4\loch
then updatedUnit}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                 }{\hich\af4\loch\lang1033\f4\loch
else gameState[x][y][z]))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                         }{\hich\af4\loch\lang1033\f4\loch
(0 ..< width))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                  }{\hich\af4\loch\lang1033\f4\loch
(0 ..< height)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                  }{\hich\af4\loch\lang1033\f4\loch
(0 ..< depth)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
updateGameState newTargetHealth gameState}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let heal : (GameState, (i8, i8, i8), (i8, i8, i8)) -> GameState =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
  }{\hich\af4\loch\lang1033\f4\loch
\\ (gameState, (healerX, healerY, healerZ), (targetX, targetY, targetZ)) ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let (width, height, depth) = (22, 22, 44)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let healerHealing = gameState[toIndex healerX][toIndex healerY][0][2]}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let (targetHealth, _, _, _, _, _, _, originalHealth, _) = gameState[toIndex targetX][toIndex targetY][0]}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let dx = abs(healerX - targetX)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let dy = abs(healerY - targetY)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let dz = abs(healerZ - targetZ)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let isNeighbor = dx <= 1 && dy <= 1 && dz <= 1}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let isInjured = targetHealth < originalHealth}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
if isNeighbor && isInjured}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
then}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
let newTargetHealth = min(originalHealth, targetHealth + healerHealing)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
let updatedUnit = [newTargetHealth] ++ gameState[toIndex targetX][toIndex targetY][0][1:]}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
let updatedGameState = map (\\z ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                  }{\hich\af4\loch\lang1033\f4\loch
map (\\y' ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                        }{\hich\af4\loch\lang1033\f4\loch
map (\\x' ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                              }{\hich\af4\loch\lang1033\f4\loch
if (x', y', z') == (targetX, targetY, targetZ)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                              }{\hich\af4\loch\lang1033\f4\loch
then updatedUnit}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                              }{\hich\af4\loch\lang1033\f4\loch
else gameState[x'][y'][z'])}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                            }{\hich\af4\loch\lang1033\f4\loch
(0 ..< height))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                      }{\hich\af4\loch\lang1033\f4\loch
(0 ..< width))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                }{\hich\af4\loch\lang1033\f4\loch
(0 ..< depth)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
updatedGameState}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
else}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
gameState}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let placeUnit : (GameState, (i8, i8), UnitAttributes, [(i8, i8, i8)]) -> (GameState, [(i8, i8, i8)]) =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
  }{\hich\af4\loch\lang1033\f4\loch
\\ (gameState, (x, y), unitAttrs, gameLog) ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let (health, attack, speed, range, flying, areaEffect, cardID, instance) = unitAttrs}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
let isOccupied = gameState[x][y][0] != -1 || gameState[x][y][1] != -1}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
if isOccupied}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
then}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
(gameState, gameLog)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
else}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
let updatedLocation = [health, attack, speed, range, flying, areaEffect, cardID, instance]}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
let updatedLayer = map (\\layer -> updatedLocation) (gameState[x])}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
let updatedState = map (\\grid -> updatedLayer) gameState}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
let updatedGameLog = gameLog ++ [(x, y, cardID)]}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
            }{\hich\af4\loch\lang1033\f4\loch
if updatedState[0][0][0] == -1 && updatedState[0][0][1] == -1}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
            }{\hich\af4\loch\lang1033\f4\loch
then (updatedState, updatedGameLog)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
            }{\hich\af4\loch\lang1033\f4\loch
else (gameState, gameLog)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch
{\*\bkmkstart __DdeLink__599_2946212008}{\*\bkmkend __DdeLink__599_2946212008}{\*\bkmkstart __DdeLink__599_2946212008}{\*\bkmkend __DdeLink__599_2946212008}
}
text/richtext
147eb
{\rtf1\ansi\deff3\adeflang1025
{\fonttbl{\f0\froman\fprq2\fcharset0 Times New Roman;}{\f1\froman\fprq2\fcharset2 Symbol;}{\f2\fswiss\fprq2\fcharset0 Arial;}{\f3\froman\fprq2\fcharset0 Carlito{\*\falt Calibri};}{\f4\fswiss\fprq2\fcharset0 Liberation Sans{\*\falt Arial};}{\f5\fmodern\fprq1\fcharset0 Liberation Mono{\*\falt Courier New};}{\f6\fnil\fprq0\fcharset2 OpenSymbol{\*\falt Arial Unicode MS};}{\f7\fmodern\fprq1\fcharset0 Noto Sans Mono CJK SC;}{\f8\fnil\fprq2\fcharset0 Noto Sans CJK SC Regular;}{\f9\fswiss\fprq0\fcharset128 Noto Sans Devanagari;}{\f10\fnil\fprq2\fcharset0 Lohit Devanagari;}}
{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0;\red255\green0\blue255;\red255\green0\blue0;\red255\green255\blue0;\red255\green255\blue255;\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;\red128\green128\blue128;\red192\green192\blue192;}
{\stylesheet{\s0\snext0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052 Normal;}
{\*\cs10\snext10\rtlch\af5 \ltrch\hich\af5\loch\f5\dbch\af7 Source Text;}
{\*\cs11\snext11\rtlch\af6 \ltrch\hich\af6\loch\f6\dbch\af6 Bullets;}
{\*\cs12\snext12\rtlch\ab \ltrch\loch\b Strong;}
{\*\cs13\snext13 Numbering Symbols;}
{\s14\sbasedon0\snext14\rtlch\af5\afs20 \ltrch\hich\af5\loch\sb0\sa0\f5\fs20\dbch\af7 Preformatted Text;}
{\s15\sbasedon0\snext15\rtlch\af9 \ltrch\loch\noline Index;}
{\s16\sbasedon0\snext16\rtlch\af9\afs24\ai \ltrch\loch\sb120\sa120\noline\fs24\i Caption;}
{\s17\sbasedon18\snext17\rtlch\af9 \ltrch\loch\sl276\slmult1\sb0\sa140 List;}
{\s18\sbasedon0\snext18\loch\sl276\slmult1\sb0\sa140 Body Text;}
{\s19\sbasedon0\snext18\rtlch\af10\afs28 \ltrch\hich\af4\loch\sb240\sa120\keepn\f4\fs28\dbch\af8 Heading;}
}{\*\generator Collabora_Office/22.05.15.2$Linux_X86_64 LibreOffice_project/e747ea966384ab782a6aac38b4ec99d38c5fd2e9}{\info{\creatim\yr0\mo0\dy0\hr0\min0}{\revtim\yr0\mo0\dy0\hr0\min0}{\printim\yr0\mo0\dy0\hr0\min0}}{\*\userprops}\deftab709
\hyphauto1
{\*\pgdsctbl
{\pgdsc0\pgdscuse451\pgwsxn12240\pghsxn15840\marglsxn1134\margrsxn1134\margtsxn1134\margbsxn1134\pgdscnxt0 Default Page Style;}}
\formshade\paperh15840\paperw12240\margl1134\margr1134\margt1134\margb1134\sectd\sbknone\pgndec\sftnnar\saftnnrlc\sectunlocked1\pgwsxn12240\pghsxn15840\marglsxn1134\margrsxn1134\margtsxn1134\margbsxn1134\ftnbj\ftnstart1\ftnrstcont\ftnnar\aenddoc\aftnrstcont\aftnstart1\aftnnrlc
{\*\ftnsep\chftnsep}\pgndec\pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
{\*\bkmkstart __DdeLink__599_2946212008}{\*\bkmkend __DdeLink__599_2946212008}type UnitAttributes = (Bool,   -- playerID}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                       }{\hich\af4\loch\lang1033\f4\loch
f32,    -- speed}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                       }{\hich\af4\loch\lang1033\f4\loch
i8,     -- health}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                       }{\hich\af4\loch\lang1033\f4\loch
i8,     -- attack}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                       }{\hich\af4\loch\lang1033\f4\loch
f32,    -- range}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                       }{\hich\af4\loch\lang1033\f4\loch
Bool,   -- flying}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                       }{\hich\af4\loch\lang1033\f4\loch
Bool,   -- areaEffect}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                       }{\hich\af4\loch\lang1033\f4\loch
i8,     -- healing}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                       }{\hich\af4\loch\lang1033\f4\loch
i8,     -- originalHealth}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                       }{\hich\af4\loch\lang1033\f4\loch
i8,     -- cardID}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                       }{\hich\af4\loch\lang1033\f4\loch
i8)     -- instance}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let coordinateMapping : [(i8, i8)] -> [(i8, i8, i8)] =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
  }{\hich\af4\loch\lang1033\f4\loch
\\coords ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let zStart = 22 : i8}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
width = 22 : i8}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
height = 22 : i8}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
depth = 44 : i8}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
map (\\(x, y) -> (x, y, -(x + y))) coords}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let allCoordinates : [(i8, i8)] =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
  }{\hich\af4\loch\lang1033\f4\loch
concat (map (\\x -> map (\\y -> (x, y)) (0 ..< 14 : i8)) (0 ..< 12 : i8))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let cubeCoordinates = coordinateMapping allCoordinates}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let placeUnit : (GameState, (i8, i8), UnitAttributes, [(i8, i8, i8)]) -> (GameState, [(i8, i8, i8)]) =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
  }{\hich\af4\loch\lang1033\f4\loch
\\ (gameState, (x, y), unitAttrs, gameLog) ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let (health, attack, speed, range, flying, areaEffect, cardID, instance, playerID) = unitAttrs}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let (width, height, depth) = (22, 22, 44)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let isOccupied = gameState[x][y][0] != -1 || gameState[x][y][1] != -1}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
if isOccupied}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
then}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
(gameState, gameLog)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
else}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
let updatedGameState = map (\\z ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                  }{\hich\af4\loch\lang1033\f4\loch
map (\\y' ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                        }{\hich\af4\loch\lang1033\f4\loch
map (\\x' ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                              }{\hich\af4\loch\lang1033\f4\loch
let attrs = gameState[x'][y'][z']}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                              }{\hich\af4\loch\lang1033\f4\loch
if attrs[0] == -1 || (attrs[0] == -1 && attrs[1] == -1)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                              }{\hich\af4\loch\lang1033\f4\loch
then if playerID == False && attrs[7] == instance}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                   }{\hich\af4\loch\lang1033\f4\loch
then [health, attack, speed, range, flying, areaEffect, cardID, instance, playerID]}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                   }{\hich\af4\loch\lang1033\f4\loch
else if playerID == True && attrs[7] == instance + 1}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                        }{\hich\af4\loch\lang1033\f4\loch
then [health, attack, speed, range, flying, areaEffect, cardID, instance, playerID]}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                        }{\hich\af4\loch\lang1033\f4\loch
else attrs}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                              }{\hich\af4\loch\lang1033\f4\loch
else attrs)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                            }{\hich\af4\loch\lang1033\f4\loch
(0 ..< height))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                      }{\hich\af4\loch\lang1033\f4\loch
(0 ..< width))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                }{\hich\af4\loch\lang1033\f4\loch
(0 ..< depth)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
updatedGameLog = gameLog ++ [(x, y, cardID)]}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
(updatedGameState, updatedGameLog)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let payMana : Mana -> i8 -> i8 -> Color -> (Mana, Bool) =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
  }{\hich\af4\loch\lang1033\f4\loch
\\ mana colorCost neutralCost color ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let (enoughColorMana, newColorMana, newChromeMana) = case color of}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                          }{\hich\af4\loch\lang1033\f4\loch
Red -> if mana.red + mana.chrome >= colorCost}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                                 }{\hich\af4\loch\lang1033\f4\loch
then (True, mana.red - colorCost, if mana.red >= colorCost then mana.chrome else mana.chrome - (colorCost - mana.red))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                                 }{\hich\af4\loch\lang1033\f4\loch
else (False, mana.red, mana.chrome)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                          }{\hich\af4\loch\lang1033\f4\loch
Green -> if mana.green + mana.chrome >= colorCost}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                                   }{\hich\af4\loch\lang1033\f4\loch
then (True, mana.green - colorCost, if mana.green >= colorCost then mana.chrome else mana.chrome - (colorCost - mana.green))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                                   }{\hich\af4\loch\lang1033\f4\loch
else (False, mana.green, mana.chrome)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                          }{\hich\af4\loch\lang1033\f4\loch
Blue -> if mana.blue + mana.chrome >= colorCost}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                                  }{\hich\af4\loch\lang1033\f4\loch
then (True, mana.blue - colorCost, if mana.blue >= colorCost then mana.chrome else mana.chrome - (colorCost - mana.blue))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                                  }{\hich\af4\loch\lang1033\f4\loch
else (False, mana.blue, mana.chrome)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                          }{\hich\af4\loch\lang1033\f4\loch
Yellow -> if mana.yellow + mana.chrome >= colorCost}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                                    }{\hich\af4\loch\lang1033\f4\loch
then (True, mana.yellow - colorCost, if mana.yellow >= colorCost then mana.chrome else mana.chrome - (colorCost - mana.yellow))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                                                    }{\hich\af4\loch\lang1033\f4\loch
else (False, mana.yellow, mana.chrome)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let enoughNeutralMana = colorCost + neutralCost <= newColorMana + mana.neutral}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let newNeutralMana = if enoughNeutralMana then mana.neutral + neutralCost else mana.neutral}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
if enoughColorMana && enoughNeutralMana}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
then (\{ red = if color == Red then newColorMana else mana.red,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
green = if color == Green then newColorMana else mana.green,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
blue = if color == Blue then newColorMana else mana.blue,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
yellow = if color == Yellow then newColorMana else mana.yellow,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
neutral = newNeutralMana,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
chrome = newChromeMana \}, True)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
else (mana, False)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
-- Define a type for mana stores}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
type Mana = \{ red :: i8,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
green :: i8,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
blue :: i8,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
yellow :: i8,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
neutral :: i8 \}}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
-- Function to initialize the accumulator}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let initAccumulator : Mana =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
  }{\hich\af4\loch\lang1033\f4\loch
\{ red = 0, green = 0, blue = 0, yellow = 0, neutral = 0 \}}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
-- Function to update the accumulator when mana is spent}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let updateAccumulator : Mana -> i8 -> i8 -> Color -> Mana =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
  }{\hich\af4\loch\lang1033\f4\loch
\\ acc colorCost neutralCost color ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let newRed = if color == Red then acc.red + colorCost else acc.red}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let newGreen = if color == Green then acc.green + colorCost else acc.green}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let newBlue = if color == Blue then acc.blue + colorCost else acc.blue}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let newYellow = if color == Yellow then acc.yellow + colorCost else acc.yellow}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let newNeutral = acc.neutral + neutralCost}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
\{ red = newRed, green = newGreen, blue = newBlue, yellow = newYellow, neutral = newNeutral \}}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
-- Function to calculate available mana for each color}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let availableMana : Mana -> Mana =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
  }{\hich\af4\loch\lang1033\f4\loch
\\ spentMana ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let floorHalf = \\x -> x / 2}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
\{ red = floorHalf spentMana.red,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
green = floorHalf spentMana.green,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
blue = floorHalf spentMana.blue,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
yellow = floorHalf spentMana.yellow,}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
neutral = floorHalf spentMana.neutral \}}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let isValidMove : (i8, i8, i8, i8, [[[[i32]]]]) -> i32 =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
  }{\hich\af4\loch\lang1033\f4\loch
\\ (startX, startY, endX, endY, gameState) ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let rec bfs : [(i8, i8, i8)] -> [(i8, i8, i8)] -> i32 =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
\\ frontier visited ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
case frontier of}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
[] -> 0  -- No valid path found}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
(x, y, z) :: rest ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
            }{\hich\af4\loch\lang1033\f4\loch
let neighbors = [(x+1, y, z-1), (x+1, y-1, z), (x, y-1, z+1), (x-1, y, z+1), (x-1, y+1, z), (x, y+1, z-1)]}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                }{\hich\af4\loch\lang1033\f4\loch
validNeighbors = filter (\\(nx, ny, nz) ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                           }{\hich\af4\loch\lang1033\f4\loch
0 <= nx && nx < width &&}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                           }{\hich\af4\loch\lang1033\f4\loch
0 <= ny && ny < height &&}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                           }{\hich\af4\loch\lang1033\f4\loch
0 <= nz && nz < depth &&}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                           }{\hich\af4\loch\lang1033\f4\loch
gameState[toIndex nx][toIndex ny][toIndex nz][0] == -1)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                         }{\hich\af4\loch\lang1033\f4\loch
neighbors}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                }{\hich\af4\loch\lang1033\f4\loch
newFrontier = filter (\\(nx, ny, nz) -> not (contains (nx, ny, nz) visited)) validNeighbors}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                }{\hich\af4\loch\lang1033\f4\loch
newVisited = visited ++ newFrontier}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
            }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
if (x, y, z) == (endX, endY, 0)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
then 1  -- Valid path found}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
else bfs rest newVisited}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let width = length gameState}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
height = length (gameState[0])}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
depth = length (gameState[0][0])}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
startZ = -(startX + startY)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
endZ = -(endX + endY)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
if gameState[toIndex endX][toIndex endY][0] != -1}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
then 0  -- Destination space is occupied}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
else}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
if endZ == 0}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
then}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
let pathExists = bfs [(endX, endY, 0)] []}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
if pathExists == 1}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
then 1  -- Valid path found}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
else 0  -- No valid path found}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
else}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
let pathExists = bfs [(endX, endY, 0)] []}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
if pathExists == 1 && abs(endX - startX) + abs(endY - startY) <= speed}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
then 1  -- Valid path found}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
else 0  -- No valid path found}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let moveUnit : (GameState, (i8, i8, i8), (i8, i8, i8)) -> GameState =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
  }{\hich\af4\loch\lang1033\f4\loch
\\ (gameState, (x1, y1, z1), (x2, y2, z2)) ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let unitAttrs = gameState[toIndex x1][toIndex y1][playerId]}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
(health, attack, speed, range, flying, areaEffect, cardID, instance) = (unitAttrs[0], unitAttrs[1], unitAttrs[2], unitAttrs[3], unitAttrs[4], unitAttrs[5], unitAttrs[6], unitAttrs[7])}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
width = 22}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
height = 22}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
depth = 44}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
startZ = -(x1 + y1)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
endZ = -(x2 + y2)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let isValid = isValidMove x1 y1 z1 x2 y2 z2 gameState}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
if isValid == 0}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
then}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
gameState -- Target position is unreachable within the unit's speed limit}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
else}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
let updatedGameState = map (\\x ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                  }{\hich\af4\loch\lang1033\f4\loch
map (\\y ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                        }{\hich\af4\loch\lang1033\f4\loch
map (\\z ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                              }{\hich\af4\loch\lang1033\f4\loch
if (x, y, z) == (x1, y1, z1)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                              }{\hich\af4\loch\lang1033\f4\loch
then (-1, -1, -1.0, -1.0, False, False, -1, -1)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                              }{\hich\af4\loch\lang1033\f4\loch
else gameState[x][y][z]))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                    }{\hich\af4\loch\lang1033\f4\loch
(0 ..< width))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                }{\hich\af4\loch\lang1033\f4\loch
(0 ..< height)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                }{\hich\af4\loch\lang1033\f4\loch
(0 ..< depth)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
            }{\hich\af4\loch\lang1033\f4\loch
updatedGameState}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let attack : (GameState, (i8, i8), (i8, i8)) -> GameState =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
  }{\hich\af4\loch\lang1033\f4\loch
\\ (gameState, (x1, y1), (x2, y2)) ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let (health, attackPower, range, _, _, _, _) = gameState[toIndex x1][toIndex y1][playerId]}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
targetHealth = gameState[toIndex x2][toIndex y2][playerId][0]}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
(x1', y1', z1') = lookupCoordinate (x1, y1)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
(x2', y2', z2') = lookupCoordinate (x2, y2)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
newTargetHealth = if max(i8(abs(x2' - x1')), i8(abs(y2' - y1')), i8(abs(z2' - z1'))) <= range}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                          }{\hich\af4\loch\lang1033\f4\loch
then max(targetHealth - attackPower, 0)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                          }{\hich\af4\loch\lang1033\f4\loch
else targetHealth}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
updateGameState : i32 -> GameState -> GameState =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
\\ newHealth gameState' ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
            }{\hich\af4\loch\lang1033\f4\loch
let updatedUnit = if newHealth > 0 then [newHealth, attackPower, range, _, _, _, _, _, _, _] else []}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
            }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
              }{\hich\af4\loch\lang1033\f4\loch
map (\\x ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                     }{\hich\af4\loch\lang1033\f4\loch
map (\\y ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                           }{\hich\af4\loch\lang1033\f4\loch
map (\\z ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                 }{\hich\af4\loch\lang1033\f4\loch
if (x, y, z) == (x2', y2', z2')}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                 }{\hich\af4\loch\lang1033\f4\loch
then updatedUnit}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                 }{\hich\af4\loch\lang1033\f4\loch
else gameState[x][y][z]))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                         }{\hich\af4\loch\lang1033\f4\loch
(0 ..< width))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                  }{\hich\af4\loch\lang1033\f4\loch
(0 ..< height)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                  }{\hich\af4\loch\lang1033\f4\loch
(0 ..< depth)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
updateGameState newTargetHealth gameState}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let heal : (GameState, (i8, i8, i8), (i8, i8, i8)) -> GameState =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
  }{\hich\af4\loch\lang1033\f4\loch
\\ (gameState, (healerX, healerY, healerZ), (targetX, targetY, targetZ)) ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let (width, height, depth) = (22, 22, 44)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let healerHealing = gameState[toIndex healerX][toIndex healerY][0][2]}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let (targetHealth, _, _, _, _, _, _, originalHealth, _) = gameState[toIndex targetX][toIndex targetY][0]}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let dx = abs(healerX - targetX)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let dy = abs(healerY - targetY)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let dz = abs(healerZ - targetZ)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let isNeighbor = dx <= 1 && dy <= 1 && dz <= 1}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let isInjured = targetHealth < originalHealth}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
if isNeighbor && isInjured}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
then}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
let newTargetHealth = min(originalHealth, targetHealth + healerHealing)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
let updatedUnit = [newTargetHealth] ++ gameState[toIndex targetX][toIndex targetY][0][1:]}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
let updatedGameState = map (\\z ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                  }{\hich\af4\loch\lang1033\f4\loch
map (\\y' ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                        }{\hich\af4\loch\lang1033\f4\loch
map (\\x' ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                              }{\hich\af4\loch\lang1033\f4\loch
if (x', y', z') == (targetX, targetY, targetZ)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                              }{\hich\af4\loch\lang1033\f4\loch
then updatedUnit}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                              }{\hich\af4\loch\lang1033\f4\loch
else gameState[x'][y'][z'])}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                            }{\hich\af4\loch\lang1033\f4\loch
(0 ..< height))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                      }{\hich\af4\loch\lang1033\f4\loch
(0 ..< width))}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
                                }{\hich\af4\loch\lang1033\f4\loch
(0 ..< depth)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
updatedGameState}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
else}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
gameState}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4\loch
let placeUnit : (GameState, (i8, i8), UnitAttributes, [(i8, i8, i8)]) -> (GameState, [(i8, i8, i8)]) =}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
  }{\hich\af4\loch\lang1033\f4\loch
\\ (gameState, (x, y), unitAttrs, gameLog) ->}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
let (health, attack, speed, range, flying, areaEffect, cardID, instance) = unitAttrs}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
    }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
let isOccupied = gameState[x][y][0] != -1 || gameState[x][y][1] != -1}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
      }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
if isOccupied}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
then}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
(gameState, gameLog)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
        }{\hich\af4\loch\lang1033\f4\loch
else}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
let updatedLocation = [health, attack, speed, range, flying, areaEffect, cardID, instance]}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
let updatedLayer = map (\\layer -> updatedLocation) (gameState[x])}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
let updatedState = map (\\grid -> updatedLayer) gameState}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
let updatedGameLog = gameLog ++ [(x, y, cardID)]}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
          }{\hich\af4\loch\lang1033\f4\loch
in}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
            }{\hich\af4\loch\lang1033\f4\loch
if updatedState[0][0][0] == -1 && updatedState[0][0][1] == -1}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
            }{\hich\af4\loch\lang1033\f4\loch
then (updatedState, updatedGameLog)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar{\hich\af4\loch\lang1033\f4
            }{\hich\af4\loch\lang1033\f4\loch
else (gameState, gameLog)}
\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch

\par \pard\plain \s0\rtlch\af12\afs24\alang1081 \ltrch\lang1033\langfe2052\hich\af3\loch\widctlpar\hyphpar0\ltrpar\cf0\f3\fs24\lang1033\kerning1\dbch\af11\langfe2052\ql\ltrpar\hich\af4\loch\lang1033\f4\loch
{\*\bkmkstart __DdeLink__599_2946212008}{\*\bkmkend __DdeLink__599_2946212008}{\*\bkmkstart __DdeLink__599_2946212008}{\*\bkmkend __DdeLink__599_2946212008}
}
text/html
a0c0



	
	
	

	
	
	

type UnitAttributes = (Bool,   -- playerID
                       f32,    -- speed
                       i8,     -- health
                       i8,     -- attack
                       f32,    -- range
                       Bool,   -- flying
                       Bool,   -- areaEffect
                       i8,     -- healing
                       i8,     -- originalHealth
                       i8,     -- cardID
                       i8)     -- instance



let coordinateMapping : [(i8, i8)] -> [(i8, i8, i8)] =
  \coords ->
    let zStart = 22 : i8
        width = 22 : i8
        height = 22 : i8
        depth = 44 : i8
    in
      map (\(x, y) -> (x, y, -(x + y))) coords

let allCoordinates : [(i8, i8)] =
  concat (map (\x -> map (\y -> (x, y)) (0 ..< 14 : i8)) (0 ..< 12 : i8))

let cubeCoordinates = coordinateMapping allCoordinates



let placeUnit : (GameState, (i8, i8), UnitAttributes, [(i8, i8, i8)]) -> (GameState, [(i8, i8, i8)]) =
  \ (gameState, (x, y), unitAttrs, gameLog) ->
    let (health, attack, speed, range, flying, areaEffect, cardID, instance, playerID) = unitAttrs
    let (width, height, depth) = (22, 22, 44)

    let isOccupied = gameState[x][y][0] != -1 || gameState[x][y][1] != -1

    if isOccupied
    then
      (gameState, gameLog)
    else
      let updatedGameState = map (\z ->
                                  map (\y' ->
                                        map (\x' ->
                                              let attrs = gameState[x'][y'][z']
                                              if attrs[0] == -1 || (attrs[0] == -1 && attrs[1] == -1)
                                              then if playerID == False && attrs[7] == instance
                                                   then [health, attack, speed, range, flying, areaEffect, cardID, instance, playerID]
                                                   else if playerID == True && attrs[7] == instance + 1
                                                        then [health, attack, speed, range, flying, areaEffect, cardID, instance, playerID]
                                                        else attrs
                                              else attrs)
                                            (0 ..< height))
                                      (0 ..< width))
                                (0 ..< depth)

          updatedGameLog = gameLog ++ [(x, y, cardID)]

      in
        (updatedGameState, updatedGameLog)

let payMana : Mana -> i8 -> i8 -> Color -> (Mana, Bool) =
  \ mana colorCost neutralCost color ->
    let (enoughColorMana, newColorMana, newChromeMana) = case color of
                                                          Red -> if mana.red + mana.chrome >= colorCost
                                                                 then (True, mana.red - colorCost, if mana.red >= colorCost then mana.chrome else mana.chrome - (colorCost - mana.red))
                                                                 else (False, mana.red, mana.chrome)
                                                          Green -> if mana.green + mana.chrome >= colorCost
                                                                   then (True, mana.green - colorCost, if mana.green >= colorCost then mana.chrome else mana.chrome - (colorCost - mana.green))
                                                                   else (False, mana.green, mana.chrome)
                                                          Blue -> if mana.blue + mana.chrome >= colorCost
                                                                  then (True, mana.blue - colorCost, if mana.blue >= colorCost then mana.chrome else mana.chrome - (colorCost - mana.blue))
                                                                  else (False, mana.blue, mana.chrome)
                                                          Yellow -> if mana.yellow + mana.chrome >= colorCost
                                                                    then (True, mana.yellow - colorCost, if mana.yellow >= colorCost then mana.chrome else mana.chrome - (colorCost - mana.yellow))
                                                                    else (False, mana.yellow, mana.chrome)
    let enoughNeutralMana = colorCost + neutralCost <= newColorMana + mana.neutral
    let newNeutralMana = if enoughNeutralMana then mana.neutral + neutralCost else mana.neutral
    in
      if enoughColorMana && enoughNeutralMana
      then ({ red = if color == Red then newColorMana else mana.red,
              green = if color == Green then newColorMana else mana.green,
              blue = if color == Blue then newColorMana else mana.blue,
              yellow = if color == Yellow then newColorMana else mana.yellow,
              neutral = newNeutralMana,
              chrome = newChromeMana }, True)
      else (mana, False)



-- Define a type for mana stores
type Mana = { red :: i8,
              green :: i8,
              blue :: i8,
              yellow :: i8,
              neutral :: i8 }

-- Function to initialize the accumulator
let initAccumulator : Mana =
  { red = 0, green = 0, blue = 0, yellow = 0, neutral = 0 }

-- Function to update the accumulator when mana is spent
let updateAccumulator : Mana -> i8 -> i8 -> Color -> Mana =
  \ acc colorCost neutralCost color ->
    let newRed = if color == Red then acc.red + colorCost else acc.red
    let newGreen = if color == Green then acc.green + colorCost else acc.green
    let newBlue = if color == Blue then acc.blue + colorCost else acc.blue
    let newYellow = if color == Yellow then acc.yellow + colorCost else acc.yellow
    let newNeutral = acc.neutral + neutralCost
    in
      { red = newRed, green = newGreen, blue = newBlue, yellow = newYellow, neutral = newNeutral }

-- Function to calculate available mana for each color
let availableMana : Mana -> Mana =
  \ spentMana ->
    let floorHalf = \x -> x / 2
    in
      { red = floorHalf spentMana.red,
        green = floorHalf spentMana.green,
        blue = floorHalf spentMana.blue,
        yellow = floorHalf spentMana.yellow,
        neutral = floorHalf spentMana.neutral }









let isValidMove : (i8, i8, i8, i8, [[[[i32]]]]) -> i32 =
  \ (startX, startY, endX, endY, gameState) ->
    let rec bfs : [(i8, i8, i8)] -> [(i8, i8, i8)] -> i32 =
      \ frontier visited ->
        case frontier of
          [] -> 0  -- No valid path found
          (x, y, z) :: rest ->
            let neighbors = [(x+1, y, z-1), (x+1, y-1, z), (x, y-1, z+1), (x-1, y, z+1), (x-1, y+1, z), (x, y+1, z-1)]
                validNeighbors = filter (\(nx, ny, nz) ->
                                           0 <= nx && nx < width &&
                                           0 <= ny && ny < height &&
                                           0 <= nz && nz < depth &&
                                           gameState[toIndex nx][toIndex ny][toIndex nz][0] == -1)
                                         neighbors
                newFrontier = filter (\(nx, ny, nz) -> not (contains (nx, ny, nz) visited)) validNeighbors
                newVisited = visited ++ newFrontier
            in
              if (x, y, z) == (endX, endY, 0)
              then 1  -- Valid path found
              else bfs rest newVisited

    let width = length gameState
        height = length (gameState[0])
        depth = length (gameState[0][0])
        startZ = -(startX + startY)
        endZ = -(endX + endY)

    if gameState[toIndex endX][toIndex endY][0] != -1
    then 0  -- Destination space is occupied
    else
      if endZ == 0
      then
        let pathExists = bfs [(endX, endY, 0)] []
        in
          if pathExists == 1
          then 1  -- Valid path found
          else 0  -- No valid path found
      else
        let pathExists = bfs [(endX, endY, 0)] []
        in
          if pathExists == 1 && abs(endX - startX) + abs(endY - startY) <= speed
          then 1  -- Valid path found
          else 0  -- No valid path found

let moveUnit : (GameState, (i8, i8, i8), (i8, i8, i8)) -> GameState =
  \ (gameState, (x1, y1, z1), (x2, y2, z2)) ->
    let unitAttrs = gameState[toIndex x1][toIndex y1][playerId]
        (health, attack, speed, range, flying, areaEffect, cardID, instance) = (unitAttrs[0], unitAttrs[1], unitAttrs[2], unitAttrs[3], unitAttrs[4], unitAttrs[5], unitAttrs[6], unitAttrs[7])
        width = 22
        height = 22
        depth = 44
        startZ = -(x1 + y1)
        endZ = -(x2 + y2)

    let isValid = isValidMove x1 y1 z1 x2 y2 z2 gameState
    if isValid == 0
    then
      gameState -- Target position is unreachable within the unit's speed limit
    else
      let updatedGameState = map (\x ->
                                  map (\y ->
                                        map (\z ->
                                              if (x, y, z) == (x1, y1, z1)
                                              then (-1, -1, -1.0, -1.0, False, False, -1, -1)
                                              else gameState[x][y][z]))
                                    (0 ..< width))
                                (0 ..< height)
                                (0 ..< depth)

          in
            updatedGameState


let attack : (GameState, (i8, i8), (i8, i8)) -> GameState =
  \ (gameState, (x1, y1), (x2, y2)) ->
    let (health, attackPower, range, _, _, _, _) = gameState[toIndex x1][toIndex y1][playerId]
        targetHealth = gameState[toIndex x2][toIndex y2][playerId][0]
        (x1', y1', z1') = lookupCoordinate (x1, y1)
        (x2', y2', z2') = lookupCoordinate (x2, y2)
        newTargetHealth = if max(i8(abs(x2' - x1')), i8(abs(y2' - y1')), i8(abs(z2' - z1'))) <= range
                          then max(targetHealth - attackPower, 0)
                          else targetHealth
        updateGameState : i32 -> GameState -> GameState =
          \ newHealth gameState' ->
            let updatedUnit = if newHealth > 0 then [newHealth, attackPower, range, _, _, _, _, _, _, _] else []
            in
              map (\x ->
                     map (\y ->
                           map (\z ->
                                 if (x, y, z) == (x2', y2', z2')
                                 then updatedUnit
                                 else gameState[x][y][z]))
                         (0 ..< width))
                  (0 ..< height)
                  (0 ..< depth)
    in
      updateGameState newTargetHealth gameState


let heal : (GameState, (i8, i8, i8), (i8, i8, i8)) -> GameState =
  \ (gameState, (healerX, healerY, healerZ), (targetX, targetY, targetZ)) ->
    let (width, height, depth) = (22, 22, 44)

    let healerHealing = gameState[toIndex healerX][toIndex healerY][0][2]

    let (targetHealth, _, _, _, _, _, _, originalHealth, _) = gameState[toIndex targetX][toIndex targetY][0]

    let dx = abs(healerX - targetX)
    let dy = abs(healerY - targetY)
    let dz = abs(healerZ - targetZ)

    let isNeighbor = dx <= 1 && dy <= 1 && dz <= 1

    let isInjured = targetHealth < originalHealth

    if isNeighbor && isInjured
    then
      let newTargetHealth = min(originalHealth, targetHealth + healerHealing)
      let updatedUnit = [newTargetHealth] ++ gameState[toIndex targetX][toIndex targetY][0][1:]
      let updatedGameState = map (\z ->
                                  map (\y' ->
                                        map (\x' ->
                                              if (x', y', z') == (targetX, targetY, targetZ)
                                              then updatedUnit
                                              else gameState[x'][y'][z'])
                                            (0 ..< height))
                                      (0 ..< width))
                                (0 ..< depth)
      in
        updatedGameState
    else
      gameState














let placeUnit : (GameState, (i8, i8), UnitAttributes, [(i8, i8, i8)]) -> (GameState, [(i8, i8, i8)]) =
  \ (gameState, (x, y), unitAttrs, gameLog) ->
    let (health, attack, speed, range, flying, areaEffect, cardID, instance) = unitAttrs
    in
      let isOccupied = gameState[x][y][0] != -1 || gameState[x][y][1] != -1
      in
        if isOccupied
        then
          (gameState, gameLog)
        else
          let updatedLocation = [health, attack, speed, range, flying, areaEffect, cardID, instance]
          let updatedLayer = map (\layer -> updatedLocation) (gameState[x])
          let updatedState = map (\grid -> updatedLayer) gameState
          let updatedGameLog = gameLog ++ [(x, y, cardID)]
          in
            if updatedState[0][0][0] == -1 && updatedState[0][0][1] == -1
            then (updatedState, updatedGameLog)
            else (gameState, gameLog)




text/plain;charset=utf-8
31e9
type UnitAttributes = (Bool,   -- playerID
                       f32,    -- speed
                       i8,     -- health
                       i8,     -- attack
                       f32,    -- range
                       Bool,   -- flying
                       Bool,   -- areaEffect
                       i8,     -- healing
                       i8,     -- originalHealth
                       i8,     -- cardID
                       i8)     -- instance



let coordinateMapping : [(i8, i8)] -> [(i8, i8, i8)] =
  \coords ->
    let zStart = 22 : i8
        width = 22 : i8
        height = 22 : i8
        depth = 44 : i8
    in
      map (\(x, y) -> (x, y, -(x + y))) coords

let allCoordinates : [(i8, i8)] =
  concat (map (\x -> map (\y -> (x, y)) (0 ..< 14 : i8)) (0 ..< 12 : i8))

let cubeCoordinates = coordinateMapping allCoordinates



let placeUnit : (GameState, (i8, i8), UnitAttributes, [(i8, i8, i8)]) -> (GameState, [(i8, i8, i8)]) =
  \ (gameState, (x, y), unitAttrs, gameLog) ->
    let (health, attack, speed, range, flying, areaEffect, cardID, instance, playerID) = unitAttrs
    let (width, height, depth) = (22, 22, 44)

    let isOccupied = gameState[x][y][0] != -1 || gameState[x][y][1] != -1

    if isOccupied
    then
      (gameState, gameLog)
    else
      let updatedGameState = map (\z ->
                                  map (\y' ->
                                        map (\x' ->
                                              let attrs = gameState[x'][y'][z']
                                              if attrs[0] == -1 || (attrs[0] == -1 && attrs[1] == -1)
                                              then if playerID == False && attrs[7] == instance
                                                   then [health, attack, speed, range, flying, areaEffect, cardID, instance, playerID]
                                                   else if playerID == True && attrs[7] == instance + 1
                                                        then [health, attack, speed, range, flying, areaEffect, cardID, instance, playerID]
                                                        else attrs
                                              else attrs)
                                            (0 ..< height))
                                      (0 ..< width))
                                (0 ..< depth)

          updatedGameLog = gameLog ++ [(x, y, cardID)]

      in
        (updatedGameState, updatedGameLog)

let payMana : Mana -> i8 -> i8 -> Color -> (Mana, Bool) =
  \ mana colorCost neutralCost color ->
    let (enoughColorMana, newColorMana, newChromeMana) = case color of
                                                          Red -> if mana.red + mana.chrome >= colorCost
                                                                 then (True, mana.red - colorCost, if mana.red >= colorCost then mana.chrome else mana.chrome - (colorCost - mana.red))
                                                                 else (False, mana.red, mana.chrome)
                                                          Green -> if mana.green + mana.chrome >= colorCost
                                                                   then (True, mana.green - colorCost, if mana.green >= colorCost then mana.chrome else mana.chrome - (colorCost - mana.green))
                                                                   else (False, mana.green, mana.chrome)
                                                          Blue -> if mana.blue + mana.chrome >= colorCost
                                                                  then (True, mana.blue - colorCost, if mana.blue >= colorCost then mana.chrome else mana.chrome - (colorCost - mana.blue))
                                                                  else (False, mana.blue, mana.chrome)
                                                          Yellow -> if mana.yellow + mana.chrome >= colorCost
                                                                    then (True, mana.yellow - colorCost, if mana.yellow >= colorCost then mana.chrome else mana.chrome - (colorCost - mana.yellow))
                                                                    else (False, mana.yellow, mana.chrome)
    let enoughNeutralMana = colorCost + neutralCost <= newColorMana + mana.neutral
    let newNeutralMana = if enoughNeutralMana then mana.neutral + neutralCost else mana.neutral
    in
      if enoughColorMana && enoughNeutralMana
      then ({ red = if color == Red then newColorMana else mana.red,
              green = if color == Green then newColorMana else mana.green,
              blue = if color == Blue then newColorMana else mana.blue,
              yellow = if color == Yellow then newColorMana else mana.yellow,
              neutral = newNeutralMana,
              chrome = newChromeMana }, True)
      else (mana, False)



-- Define a type for mana stores
type Mana = { red :: i8,
              green :: i8,
              blue :: i8,
              yellow :: i8,
              neutral :: i8 }

-- Function to initialize the accumulator
let initAccumulator : Mana =
  { red = 0, green = 0, blue = 0, yellow = 0, neutral = 0 }

-- Function to update the accumulator when mana is spent
let updateAccumulator : Mana -> i8 -> i8 -> Color -> Mana =
  \ acc colorCost neutralCost color ->
    let newRed = if color == Red then acc.red + colorCost else acc.red
    let newGreen = if color == Green then acc.green + colorCost else acc.green
    let newBlue = if color == Blue then acc.blue + colorCost else acc.blue
    let newYellow = if color == Yellow then acc.yellow + colorCost else acc.yellow
    let newNeutral = acc.neutral + neutralCost
    in
      { red = newRed, green = newGreen, blue = newBlue, yellow = newYellow, neutral = newNeutral }

-- Function to calculate available mana for each color
let availableMana : Mana -> Mana =
  \ spentMana ->
    let floorHalf = \x -> x / 2
    in
      { red = floorHalf spentMana.red,
        green = floorHalf spentMana.green,
        blue = floorHalf spentMana.blue,
        yellow = floorHalf spentMana.yellow,
        neutral = floorHalf spentMana.neutral }









let isValidMove : (i8, i8, i8, i8, [[[[i32]]]]) -> i32 =
  \ (startX, startY, endX, endY, gameState) ->
    let rec bfs : [(i8, i8, i8)] -> [(i8, i8, i8)] -> i32 =
      \ frontier visited ->
        case frontier of
          [] -> 0  -- No valid path found
          (x, y, z) :: rest ->
            let neighbors = [(x+1, y, z-1), (x+1, y-1, z), (x, y-1, z+1), (x-1, y, z+1), (x-1, y+1, z), (x, y+1, z-1)]
                validNeighbors = filter (\(nx, ny, nz) ->
                                           0 <= nx && nx < width &&
                                           0 <= ny && ny < height &&
                                           0 <= nz && nz < depth &&
                                           gameState[toIndex nx][toIndex ny][toIndex nz][0] == -1)
                                         neighbors
                newFrontier = filter (\(nx, ny, nz) -> not (contains (nx, ny, nz) visited)) validNeighbors
                newVisited = visited ++ newFrontier
            in
              if (x, y, z) == (endX, endY, 0)
              then 1  -- Valid path found
              else bfs rest newVisited

    let width = length gameState
        height = length (gameState[0])
        depth = length (gameState[0][0])
        startZ = -(startX + startY)
        endZ = -(endX + endY)

    if gameState[toIndex endX][toIndex endY][0] != -1
    then 0  -- Destination space is occupied
    else
      if endZ == 0
      then
        let pathExists = bfs [(endX, endY, 0)] []
        in
          if pathExists == 1
          then 1  -- Valid path found
          else 0  -- No valid path found
      else
        let pathExists = bfs [(endX, endY, 0)] []
        in
          if pathExists == 1 && abs(endX - startX) + abs(endY - startY) <= speed
          then 1  -- Valid path found
          else 0  -- No valid path found

let moveUnit : (GameState, (i8, i8, i8), (i8, i8, i8)) -> GameState =
  \ (gameState, (x1, y1, z1), (x2, y2, z2)) ->
    let unitAttrs = gameState[toIndex x1][toIndex y1][playerId]
        (health, attack, speed, range, flying, areaEffect, cardID, instance) = (unitAttrs[0], unitAttrs[1], unitAttrs[2], unitAttrs[3], unitAttrs[4], unitAttrs[5], unitAttrs[6], unitAttrs[7])
        width = 22
        height = 22
        depth = 44
        startZ = -(x1 + y1)
        endZ = -(x2 + y2)

    let isValid = isValidMove x1 y1 z1 x2 y2 z2 gameState
    if isValid == 0
    then
      gameState -- Target position is unreachable within the unit's speed limit
    else
      let updatedGameState = map (\x ->
                                  map (\y ->
                                        map (\z ->
                                              if (x, y, z) == (x1, y1, z1)
                                              then (-1, -1, -1.0, -1.0, False, False, -1, -1)
                                              else gameState[x][y][z]))
                                    (0 ..< width))
                                (0 ..< height)
                                (0 ..< depth)

          in
            updatedGameState


let attack : (GameState, (i8, i8), (i8, i8)) -> GameState =
  \ (gameState, (x1, y1), (x2, y2)) ->
    let (health, attackPower, range, _, _, _, _) = gameState[toIndex x1][toIndex y1][playerId]
        targetHealth = gameState[toIndex x2][toIndex y2][playerId][0]
        (x1', y1', z1') = lookupCoordinate (x1, y1)
        (x2', y2', z2') = lookupCoordinate (x2, y2)
        newTargetHealth = if max(i8(abs(x2' - x1')), i8(abs(y2' - y1')), i8(abs(z2' - z1'))) <= range
                          then max(targetHealth - attackPower, 0)
                          else targetHealth
        updateGameState : i32 -> GameState -> GameState =
          \ newHealth gameState' ->
            let updatedUnit = if newHealth > 0 then [newHealth, attackPower, range, _, _, _, _, _, _, _] else []
            in
              map (\x ->
                     map (\y ->
                           map (\z ->
                                 if (x, y, z) == (x2', y2', z2')
                                 then updatedUnit
                                 else gameState[x][y][z]))
                         (0 ..< width))
                  (0 ..< height)
                  (0 ..< depth)
    in
      updateGameState newTargetHealth gameState


let heal : (GameState, (i8, i8, i8), (i8, i8, i8)) -> GameState =
  \ (gameState, (healerX, healerY, healerZ), (targetX, targetY, targetZ)) ->
    let (width, height, depth) = (22, 22, 44)

    let healerHealing = gameState[toIndex healerX][toIndex healerY][0][2]

    let (targetHealth, _, _, _, _, _, _, originalHealth, _) = gameState[toIndex targetX][toIndex targetY][0]

    let dx = abs(healerX - targetX)
    let dy = abs(healerY - targetY)
    let dz = abs(healerZ - targetZ)

    let isNeighbor = dx <= 1 && dy <= 1 && dz <= 1

    let isInjured = targetHealth < originalHealth

    if isNeighbor && isInjured
    then
      let newTargetHealth = min(originalHealth, targetHealth + healerHealing)
      let updatedUnit = [newTargetHealth] ++ gameState[toIndex targetX][toIndex targetY][0][1:]
      let updatedGameState = map (\z ->
                                  map (\y' ->
                                        map (\x' ->
                                              if (x', y', z') == (targetX, targetY, targetZ)
                                              then updatedUnit
                                              else gameState[x'][y'][z'])
                                            (0 ..< height))
                                      (0 ..< width))
                                (0 ..< depth)
      in
        updatedGameState
    else
      gameState














let placeUnit : (GameState, (i8, i8), UnitAttributes, [(i8, i8, i8)]) -> (GameState, [(i8, i8, i8)]) =
  \ (gameState, (x, y), unitAttrs, gameLog) ->
    let (health, attack, speed, range, flying, areaEffect, cardID, instance) = unitAttrs
    in
      let isOccupied = gameState[x][y][0] != -1 || gameState[x][y][1] != -1
      in
        if isOccupied
        then
          (gameState, gameLog)
        else
          let updatedLocation = [health, attack, speed, range, flying, areaEffect, cardID, instance]
          let updatedLayer = map (\layer -> updatedLocation) (gameState[x])
          let updatedState = map (\grid -> updatedLayer) gameState
          let updatedGameLog = gameLog ++ [(x, y, cardID)]
          in
            if updatedState[0][0][0] == -1 && updatedState[0][0][1] == -1
            then (updatedState, updatedGameLog)
            else (gameState, gameLog)


application/x-openoffice-link;windows_formatname="Link"
51
soffice/tmp/user/docs/IvLFJCXwGasPT7BJ/Code BAse.odt__DdeLink__608_2946212008
application/x-openoffice-objectdescriptor-xml;windows_formatname="Star Object Descriptor (XML)";classname="8BC6B165-B1B2-4EDD-aa47-dae2ee689dd6";typename="Collabora Office 22.05 Text Document";displayname="file:///tmp/user/docs/IvLFJCXwGasPT7BJ/Code BAse.odt";viewaspect="1";width="17000";height="3000";posx="0";posy="0"
8c
ï¿½eï¿½Æ‹ï¿½ï¿½ï¿½Nï¿½Gï¿½ï¿½ï¿½hï¿½ï¿½hBï¿½$Collabora Office 22.05 Text Document4file:///tmp/user/docs/IvLFJCXwGasPT7BJ/Code BAse.odtgE#ï¿½Í«ï¿½
